# üéµ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ WebM —Ñ–æ—Ä–º–∞—Ç–∞

## –ü—Ä–æ–±–ª–µ–º–∞
–ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å YouTube yt-dlp —Å–∫–∞—á–∏–≤–∞–ª —Ñ–∞–π–ª—ã –≤ —Ñ–æ—Ä–º–∞—Ç–µ WebM, –Ω–æ —Å–∏—Å—Ç–µ–º–∞ –º–æ–¥–∞ –Ω–µ –º–æ–≥–ª–∞ –∏—Ö –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å:

```
¬ßa–í–∏–¥–µ–æ —Å–∫–∞—á–∞–Ω–æ –∏ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ –≤ MP3!
¬ß7–†–∞–∑–º–µ—Ä: 4,6 MB
¬ß7–û–±—Ä–∞–±–æ—Ç–∫–∞ –∞—É–¥–∏–æ —á–µ—Ä–µ–∑ —Å–∏—Å—Ç–µ–º—É –º–æ–¥–∞...
¬ßc–û—à–∏–±–∫–∞: Unsupported or unrecognized audio format
```

## –ü—Ä–∏—á–∏–Ω–∞
1. **AudioProcessor** –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–ª WebM —Ñ–æ—Ä–º–∞—Ç (–æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ WebM magic numbers)
2. **SimpleVoiceChatIntegration** –Ω–µ –º–æ–≥ –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å WebM (Java AudioSystem –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç WebM –Ω–∞—Ç–∏–≤–Ω–æ)
3. **yt-dlp** —Å–∫–∞—á–∏–≤–∞–ª WebM, –ø–æ—Ç–æ–º—É —á—Ç–æ OGG –±—ã–ª –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –≤–∏–¥–µ–æ

## –†–µ—à–µ–Ω–∏–µ

### ‚úÖ 1. –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ WebM –≤ AudioProcessor
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ WebM magic numbers (`0x1A 0x45 0xDF 0xA3`)
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ WebM –≤ –º–µ—Ç–æ–¥–∞—Ö `estimateDuration`, `estimateBitrate`
- WebM —Ç–µ–ø–µ—Ä—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–µ—Ç—Å—è –∫–∞–∫ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —Ñ–æ—Ä–º–∞—Ç

### ‚úÖ 2. –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ WebM –≤ SimpleVoiceChatIntegration
- –î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `isWebMFormat()` –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è WebM —Ñ–∞–π–ª–æ–≤
- –î–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ç–∫–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö –¥–ª—è WebM
- WebM –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –æ—Ç –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–º–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏

### ‚úÖ 3. –î–æ–±–∞–≤–ª–µ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è WebM ‚Üí OGG
- –ù–æ–≤—ã–π –º–µ—Ç–æ–¥ `tryConvertWebMToOgg()` –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ FFmpeg
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ WebM —Ñ–∞–π–ª–æ–≤ –≤ YouTube –∑–∞–≥—Ä—É–∑–∫–µ
- –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ OGG –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å Java AudioSystem

### ‚úÖ 4. –ò–∑–º–µ–Ω–µ–Ω –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç —Ñ–æ—Ä–º–∞—Ç–æ–≤ yt-dlp
- **–ë—ã–ª–æ:** `bestaudio[ext=ogg]/bestaudio[ext=webm]/bestaudio[ext=mp3]/bestaudio`
- **–°—Ç–∞–ª–æ:** `bestaudio[ext=mp3]/bestaudio[ext=ogg]/bestaudio`
- –£–±—Ä–∞–Ω WebM –∏–∑ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –ø—Ä–æ–±–ª–µ–º

## –ù–æ–≤–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: FFmpeg —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
```
¬ßa–í–∏–¥–µ–æ —Å–∫–∞—á–∞–Ω–æ! –ò—Å–ø–æ–ª—å–∑—É–µ–º –∏—Å—Ö–æ–¥–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç.
¬ß7–§–∞–π–ª: VIDEO_ID.webm
¬ße–í–Ω–∏–º–∞–Ω–∏–µ: WebM —Ñ–æ—Ä–º–∞—Ç –æ–±–Ω–∞—Ä—É–∂–µ–Ω
¬ßaWebM —É—Å–ø–µ—à–Ω–æ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω –≤ OGG
¬ßa‚úÖ –ê—É–¥–∏–æ —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ –Ω–∞ –¥–∏—Å–∫!
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: FFmpeg –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
```
¬ßa–í–∏–¥–µ–æ —Å–∫–∞—á–∞–Ω–æ! –ò—Å–ø–æ–ª—å–∑—É–µ–º –∏—Å—Ö–æ–¥–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç.
¬ß7–§–∞–π–ª: VIDEO_ID.webm
¬ße–í–Ω–∏–º–∞–Ω–∏–µ: WebM —Ñ–æ—Ä–º–∞—Ç –æ–±–Ω–∞—Ä—É–∂–µ–Ω
¬ßc–ù–µ —É–¥–∞–ª–æ—Å—å –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å WebM
¬ß7WebM –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è
¬ß7–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ FFmpeg –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –°–∫–∞—á–∞–ª—Å—è MP3/OGG (–ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–æ)
```
¬ßa–í–∏–¥–µ–æ —Å–∫–∞—á–∞–Ω–æ –∏ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ –≤ MP3!
¬ß7–†–∞–∑–º–µ—Ä: 4.2 MB
¬ß7–û–±—Ä–∞–±–æ—Ç–∫–∞ –∞—É–¥–∏–æ —á–µ—Ä–µ–∑ —Å–∏—Å—Ç–µ–º—É –º–æ–¥–∞...
¬ßa‚úÖ –ê—É–¥–∏–æ —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ –Ω–∞ –¥–∏—Å–∫!
```

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### WebM Magic Numbers
```java
byte[] WEBM_MAGIC = {0x1A, 0x45, (byte) 0xDF, (byte) 0xA3}; // EBML header
```

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç —Ñ–æ—Ä–º–∞—Ç–æ–≤
1. **MP3** - –ª—É—á—à–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å Java AudioSystem
2. **OGG** - —Ö–æ—Ä–æ—à–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞, –æ—Ç–∫—Ä—ã—Ç—ã–π —Ñ–æ—Ä–º–∞—Ç
3. **–õ—é–±–æ–π** - fallback –¥–ª—è —Ä–µ–¥–∫–∏—Ö —Å–ª—É—á–∞–µ–≤

### FFmpeg –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è
```bash
ffmpeg -i input.webm -c:a libvorbis -q:a 4 -y output.ogg
```

## –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω–∏–π

### –û—Å–Ω–æ–≤–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:
- `AudioProcessor.java` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ WebM —Ñ–æ—Ä–º–∞—Ç–∞
- `SimpleVoiceChatIntegration.java` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ WebM
- `AudioDiscCommand.java` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è WebM, –∏–∑–º–µ–Ω–µ–Ω –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç —Ñ–æ—Ä–º–∞—Ç–æ–≤

### –ù–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã:
- `AudioProcessor.detectFormat()` - —Ç–µ–ø–µ—Ä—å —Ä–∞—Å–ø–æ–∑–Ω–∞–µ—Ç WebM
- `SimpleVoiceChatIntegration.isWebMFormat()` - –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ WebM —Ñ–∞–π–ª–æ–≤
- `AudioDiscCommand.tryConvertWebMToOgg()` - –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è WebM –≤ OGG

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ —Å–µ—Ä–≤–µ—Ä–æ–≤:
1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ FFmpeg** –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ WebM
2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç —Ñ–æ—Ä–º–∞—Ç–æ–≤** - MP3 –∏ OGG –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–µ–µ WebM
3. **–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –ª–æ–≥–∏** –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –ø—Ä–æ–±–ª–µ–º —Å —Ñ–æ—Ä–º–∞—Ç–∞–º–∏

### –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:
1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏** - YouTube Music –æ–±—ã—á–Ω–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ª—É—á—à–∏–µ —Ñ–æ—Ä–º–∞—Ç—ã
2. **–°–æ–æ–±—â–∞–π—Ç–µ –æ –ø—Ä–æ–±–ª–µ–º–∞—Ö** –µ—Å–ª–∏ WebM –≤—Å–µ –µ—â–µ —Å–∫–∞—á–∏–≤–∞–µ—Ç—Å—è
3. **–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏—è** –º–æ–¥–∞ –æ —Å—Ç–∞—Ç—É—Å–µ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏

## –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Ñ–æ—Ä–º–∞—Ç–æ–≤

### ‚úÖ –ù–∞—Ç–∏–≤–Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è Java
- **MP3** - –æ—Ç–ª–∏—á–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞
- **OGG** - —Ö–æ—Ä–æ—à–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ (—Å –±–∏–±–ª–∏–æ—Ç–µ–∫–∞–º–∏)
- **WAV** - –≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞

### ‚ö†Ô∏è –¢—Ä–µ–±—É—é—Ç –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏
- **WebM** - –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –≤ OGG —á–µ—Ä–µ–∑ FFmpeg
- **M4A** - –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –≤ OGG —á–µ—Ä–µ–∑ FFmpeg

### ‚ùå –ù–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è
- **FLAC** - —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫
- **AAC** - –ø—Ä–æ–ø—Ä–∏–µ—Ç–∞—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç (–∫—Ä–æ–º–µ M4A –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞)

## –°—Ç–∞—Ç—É—Å: ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

WebM —Ñ–∞–π–ª—ã —Ç–µ–ø–µ—Ä—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–µ–π –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ FFmpeg –∏–ª–∏ —á–µ—Ç–∫–∏–º–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏ –ø—Ä–∏ –µ–≥–æ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏.